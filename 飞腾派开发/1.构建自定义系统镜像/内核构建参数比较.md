# 内核构建参数比较



## 注：左边是原内核，右边是自己构建的内核：

1. ![image-20240112191536811](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112191536811.png)此处是编译环境的区别：显示了编译器和链接器的区别，问题不大

2. ![image-20240112192432553](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112192432553.png)![image-20240112192731469](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112192731469.png)ARM架构构建差异

3. ![image-20240112192915057](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112192915057.png)GCC插件，这个就不删去了

4. ![image-20240112193011798](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112193011798.png)虚拟内存管理策略：`CONFIG_ARCH_USES_HIGH_VMA_FLAGS` 是Linux内核配置中的一个选项，它涉及到内核在虚拟内存区域（Virtual Memory Area，VMA）中使用高位（high VMA)标志的设置。

   具体来说：

   - `y` 表示该选项已启用，意味着内核配置了支持使用高位VMA标志。高位VMA标志是用于在虚拟地址空间中标识内存区域的标志，通常与内存映射和虚拟内存管理相关。

   - 如果将该选项设置为 `n`，则表示内核不配置支持高位VMA标志。这可能会影响内核对虚拟内存区域的管理和分配。

5. ![image-20240112193418282](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112193418282.png)这是Linux内核的一些USB网络设备驱动的配置选项。这些选项用于启用或禁用不同类型的USB网络设备驱动程序。

   以下是每个选项的含义：

   1. `CONFIG_USB_NET_CDCETHER=y`：这个选项表示启用了CDC Ethernet（通信设备类以太网）驱动程序。CDC Ethernet是一种USB网络设备标准，用于支持通过USB连接的以太网适配器。如果您有使用CDC Ethernet设备的需求，可以启用此选项。
   2. `CONFIG_USB_NET_CDC_EEM`：这个选项没有设置（注释掉了），这意味着未启用CDC EEM（Ethernet Emulation Model）驱动程序。CDC EEM是另一种USB网络设备标准，用于通过USB连接的设备之间模拟以太网连接。
   3. `CONFIG_USB_NET_CDC_NCM=y`：这个选项表示启用了CDC NCM（Network Control Model）驱动程序。CDC NCM是一种USB网络设备标准，用于支持高速网络连接，并提供更高的性能和带宽。如果您需要使用CDC NCM设备，可以启用此选项。
   4. `CONFIG_USB_NET_HUAWEI_CDC_NCM`：这个选项没有设置（注释掉了），这表示未启用华为CDC NCM驱动程序。这可能是一个特定的设备驱动程序，只有在使用华为设备时才需要。

   这些选项允许您根据您的硬件和需求，选择性地启用或禁用不同类型的USB网络设备驱动程序，以确保内核支持您的USB网络硬件。如果您的系统使用了USB网络设备，通常会根据您的硬件配置自动加载适当的驱动程序。

6. ![image-20240112193647055](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112193647055.png)这个不用管

7. ![image-20240112193814009](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112193814009.png)这个也不用管

8. ![image-20240112194017396](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112194017396.png)这个也不用管

9. ![image-20240112194216245](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112194216245.png)这些选项涉及到Linux内核中与地址无害化（Address Sanitizer）和内核地址无害化（KASAN）相关的配置。

   1. `CONFIG_CC_HAS_WORKING_NOSANITIZE_ADDRESS=y`：这个选项表示编译器已启用 Address Sanitizer（ASan）的支持，并且内核已经配置为使用有效的 Address Sanitizer 特性。Address Sanitizer 是一种内存错误检测工具，用于检测在运行时发生的内存访问错误，如缓冲区溢出和内存泄漏。这个选项启用了 ASan 的支持。
   2. `# CONFIG_KASAN is not set`：这个选项是被注释掉的，表示未启用内核地址无害化（Kernel Address Sanitizer，KASAN）。KASAN 是一种在内核中执行的 Address Sanitizer，用于检测内核模块和内核本身中的内存访问错误。在这里，KASAN 被禁用，不会在内核中启用。

   这些选项通常与内核的开发和调试相关，用于检测和修复内存访问错误。启用 Address Sanitizer 和内核地址无害化可以帮助开发者找到并修复潜在的内存错误，提高内核的稳定性和安全性。在生产环境中，通常不会启用这些选项，因为它们可能会带来一些性能开销。

10. ![image-20240112194327116](./%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA%E5%8F%82%E6%95%B0%E6%AF%94%E8%BE%83.assets/image-20240112194327116.png)`CONFIG_HAVE_DYNAMIC_FTRACE_WITH_REGS` 是Linux内核的一个配置选项，与内核的动态函数跟踪（Dynamic Function Tracing）相关。这个选项指示内核是否启用了具有寄存器信息的动态函数跟踪。

    具体来说：

    - `CONFIG_HAVE_DYNAMIC_FTRACE_WITH_REGS=y` 表示已启用具有寄存器信息的动态函数跟踪。这意味着内核跟踪工具（如ftrace）可以记录函数调用和返回，并包含有关CPU寄存器状态的信息，这对于分析和调试非常有用。
    - 如果将该选项设置为 `n`，则表示未启用具有寄存器信息的动态函数跟踪。在这种情况下，跟踪工具可能无法提供有关函数执行期间寄存器状态的信息。

    动态函数跟踪是一种在Linux内核中用于性能分析和调试的工具，它允许开发者监视和分析内核函数的执行情况。启用具有寄存器信息的动态函数跟踪可以提供更详细的分析信息，但可能会增加跟踪工具的开销。

    这个选项的启用或禁用通常取决于内核的需求和性能要求。在生产环境中，通常不会启用具有寄存器信息的动态函数跟踪，因为它可能会对性能产生一些开销。

    